# Задание 2 — Префиксная сумма (Scan) на CUDA с использованием shared memory
## 1. Цель задания

Требуется реализовать CUDA-программу для вычисления префиксной суммы массива (scan) размером 1 000 000 элементов, используя разделяемую память (shared memory).
Затем нужно сравнить время выполнения с последовательной реализацией на CPU.

## 2. Что такое префиксная сумма (inclusive scan)

Префиксная сумма (сканирование) — это операция, где каждый элемент результата равен сумме всех предыдущих элементов входа включая текущий.
Пример:

in = [2, 1, 3, 4]

out = [2, 3, 6, 10]

В этом задании реализован именно inclusive scan.

## 3. CPU-версия (последовательно)

CPU-реализация работает обычным циклом:

- создаётся переменная s

- на каждом шаге добавляем очередной элемент

- записываем текущее значение суммы в out[i]

s += in[i];

out[i] = s;


Это простой и правильный базовый вариант, с которым сравнивается GPU.

## 4. Идея GPU-решения

Один CUDA-блок не может обработать сразу весь массив из 1 000 000 элементов, поэтому используется иерархический (двухуровневый) scan:

### Шаги алгоритма:

1. Каждый блок вычисляет scan для своего кусочка массива в shared memory

2. Каждый блок сохраняет свою общую сумму блока в массив blockSums

3. Выполняется scan по массиву blockSums (то есть считаются смещения для блоков)

4. Каждый блок получает своё смещение и прибавляет его ко всем элементам своего результата

Это стандартный подход для scan на GPU.

## 5. Почему здесь используется shared memory

Shared memory быстрее глобальной памяти и подходит для операций внутри блока.
Поэтому внутри каждого блока scan делается так:

- данные загружаются из global memory → в shared memory

- выполняется параллельный алгоритм Blelloch scan

- результат записывается обратно в global memory

То есть глобальная память нужна для хранения данных, а вычисления ускоряются через shared memory.
