# Практическая работа №6  
## Программирование на OpenCL для CPU и GPU



## Цель работы

- Изучение основ программирования на OpenCL.
- Разработка кросс-платформенного приложения для выполнения параллельных вычислений на CPU и GPU.



## Описание

В рамках данной практической работы необходимо разработать приложение, выполняющее операцию элементного сложения двух массивов.  
Программа должна быть написана с использованием OpenCL и запущена как на CPU, так и на GPU для сравнения производительности.



## Задача №1

### 1. Подготовка окружения

1. Установите необходимые драйверы для OpenCL на вашей системе:
   - Для CPU: установите драйверы от производителя процессора (Intel, AMD).
   - Для GPU: установите драйверы от производителя видеокарты (NVIDIA, AMD).

2. Убедитесь, что OpenCL-библиотеки доступны в вашей системе:
   - Linux:
     ```
     /usr/lib/libOpenCL.so
     ```
   - Windows:
     ```
     OpenCL.dll
     ```

3. Настройте среду разработки (например, VS Code, CLion или Visual Studio).


### 2. Реализация задачи

#### Шаг 1. Создайте ядро OpenCL (файл `kernel.cl`)

Напишите ядро, выполняющее операцию сложения двух массивов:

```c
__kernel void vector_add(__global const float* A,
                         __global const float* B,
                         __global float* C)
{
    int id = get_global_id(0); // Определение глобального ID
    C[id] = A[id] + B[id];     // Выполнение операции сложения
}
```

#### Шаг 2. Создайте программу на C/C++

Реализуйте программу, которая:

1. Инициализирует платформу и устройство OpenCL.

2. Создаёт контекст и командную очередь.

3. Загружает и компилирует ядро.

4. Подготавливает данные (массивы A, B и C).

5. Выполняет ядро и считывает результаты.

#### Шаг 3. Выполните программу

1. Скомпилируйте код с использованием OpenCL-библиотеки.

2. Измерьте время выполнения программы на CPU и GPU (например, с использованием clock() или профилировщиков).

#### Шаг 4. Сравните производительность

Сравните производительность выполнения программы на CPU и GPU.
Отчёт должен содержать:

- Время выполнения на CPU.

- Время выполнения на GPU.

- График сравнения.

## Задача №2
## Описание задачи

Реализуйте программу для параллельного умножения двух матриц с использованием OpenCL.

Матрицы имеют следующие размеры:

Матрица A — N × M

Матрица B — M × K

Результирующая матрица C — N × K

#### Шаг 1. Создайте ядро OpenCL для матричного умножения
#### Шаг 2. Реализуйте программу

1. Подготовьте матрицы A, B и C.

2. Передайте размеры матриц (N, M, K) в качестве аргументов ядра.

3. Настройте размеры рабочей группы, соответствующие размеру матрицы C (глобальная рабочая группа).

#### Шаг 3. Проверьте корректность результатов

Сравните результаты OpenCL с последовательной реализацией матричного умножения на CPU.

## Контрольные вопросы

### 1. Какие основные типы памяти используются в OpenCL?

В OpenCL используются следующие основные типы памяти:

- **Глобальная память (global memory)** — основная память устройства, доступная всем рабочим элементам; имеет высокую задержку доступа.

- **Локальная память (local memory)** — быстрая память, общая для рабочей группы; используется для обмена данными между потоками внутри группы.

- **Частная память (private memory)** — память, доступная только одному рабочему элементу; обычно хранится в регистрах.

- **Константная память (constant memory)** — область памяти только для чтения, оптимизированная для одинакового доступа всех потоков.

### 2. Как настроить глобальную и локальную рабочую группу?

Глобальная и локальная рабочие группы настраиваются при запуске ядра OpenCL:

- **Глобальный размер (global work size)** определяет общее количество рабочих элементов, которые будут выполнять ядро.

- **Локальный размер (local work size)** определяет количество рабочих элементов в одной рабочей группе.

Размеры задаются при вызове clEnqueueNDRangeKernel() и выбираются так, чтобы:

- глобальный размер был кратен локальному;

- локальный размер соответствовал архитектуре устройства (например, 32 или 64 рабочих элемента).

### 3. Чем отличается OpenCL от CUDA?

Основные отличия OpenCL и CUDA:

- **OpenCL** — открытый стандарт, поддерживающий устройства разных производителей (CPU, GPU, FPGA).

- **CUDA** — проприетарная технология компании NVIDIA, работает только на GPU NVIDIA.

- OpenCL обеспечивает переносимость кода между платформами.

- CUDA обычно предоставляет более удобные инструменты и лучшую оптимизацию для GPU NVIDIA.

### 4. Какие преимущества даёт использование OpenCL?

Использование OpenCL даёт следующие преимущества:

- Кросс-платформенность — один код может работать на разных устройствах и архитектурах.

- Возможность использовать CPU и GPU в одном приложении.

- Масштабируемость под различные вычислительные устройства.

- Отсутствие привязки к конкретному производителю оборудования.
